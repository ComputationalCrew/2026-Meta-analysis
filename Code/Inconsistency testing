### SAS Code ###

FILENAME REFFILE '...';

PROC IMPORT DATAFILE=REFFILE
	DBMS=CSV
	OUT=WORK.IMPORT1;
	GETNAMES=YES;
RUN;

PROC CONTENTS DATA=WORK.IMPORT1; RUN;

data inconsistency;
    set WORK.IMPORT1;
    char_Trial = put(Trial, 8.);
    drop Trial;
run;

data inconsistency;
    set inconsistency;
    char_MOA = put(MOA, 8.);
    drop MOA;
run;

data inconsistency;
    set inconsistency;
    char_Rep = put(Rep, 8.);
    drop Rep;
run;

data inconsistency;
    set inconsistency;
    char_Group = put(Group, 8.);
    drop Group;
run;

data inconsistency;
    set inconsistency;
    char_Rep = put(Rep, 8.);
    drop Rep;
run;

/* New version of Larry's suggestion: better */
proc mixed data=inconsistency; 
class char_Group char_Trial char_MOA char_Rep; 
model tResponse_ratio = char_Group char_MOA char_MOA*char_Group / s chisq ddfm=kr;
random int char_MOA char_Rep/ subject=char_Trial(char_Group) type=vc g gcorr;
run;


PROC CONTENTS DATA=inconsistency; RUN;
